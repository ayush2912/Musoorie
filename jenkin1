pipeline{
agent any
stages{
 stage(compile){
    steps{
         sh 'mvn compile'
         }
}
 stage(test){
     steps{
        sh 'mvn test'
      }
}
 stage(pacakge){
steps{
        sh 'mvn package'
      }
}
 stage(deploy){
steps{
 sh 'docker kill $(docker ps -q)'
sh 'sudo docker rm $(docker ps -a -q)'
sh ' docker rmi $(docker images -a -q)'
 sh 'sudo docker build -t ayush3:$BUILD_NUMBER .'
sh' sudo docker container run -itd --name ayush$BUILD_NUMBER -p 8082:8080 ayush3:$BUILD_NUMBER '

}
}

}
}
